---
layout: post
title: C로 짜여진 Hello World! 프로그램이 실행되는 과정
subtitle: 컴퓨터 시스템의 기본을 알아보자
tags: [Algorithm]
author: Im Yongsik
comments: True
use_math: True
---

## 0. 서론

프로그래머는 코드를 작성해 컴퓨터에게 명령을 내리는 사람들이다. 여기서 중요한 건, 대부분의 프로그래머는 단지 코드를 작성해 컴퓨터에게 건넬 뿐 작성한 코드가 처리되는 과정에는 크게 관여하지 않는다는 점이다. 그렇다면 전달한 코드가 실행되기 위해 처리되는 대부분의 작업은 컴퓨터가 묵시적으로 수행해 준다는 것을 의미하는데, 과연 이 과정이 어떻게 진행되는지를 살펴보고자 한다.

## 1. 살펴볼 프로그램

우리가 살펴볼 프로그램은 C언어로 작성된 매우 유명한 예제이며, 다음과 같다.

{%highlight c%}

#include <stdio.h>

int main() {
    printf("Hello World!");
    

    return 0;

}

{%endhighlight%}

## 2. 작성한 프로그램의 실체

프로그래머라면 당연히 **아스키 코드(ASCII Code)**에 대한 개념을 알 것이다. 아스키 코드가 우리에게 주는 의미는 '컴퓨터 상의 모든 데이터는 비트 수준의 수로 이루어져 있다'는 것이다. 정수, 실수, 주소, 문자, 문자열 등 모든 데이터들은 메모리, 레지스터, 디스크 등의 비트 단위 저장 장치 상에서 0 또는 1의 집합으로 존재하며, 이들은 단지 해당 데이터가 사용되는 시점의 문맥*context*에 의지해 해석된다.

즉, 예시 프로그램에서 `#include~` 로 시작하는 프로그램 코드는 저장 장치 상에 모두 해당 코드의 아스키 코드에 사상되는 비트열로 저장되어 있으며, 출력할 `Hello World!` 문자열 역시 마찬가지이다.

## 3. 실행되기 전에 어느 곳에 존재하는가

아무튼 우리가 살펴본 프로그램이 실제로는 비트열 데이터로 저장된다는것을 안다면, 이들은 어디에 저장되어 있을까? 사실 너무 당연한 답이지만 정답은 '프로그램이 실행될 시스템의 보조 저장 장치'이다.

실행되지 않는 프로그램은 모두 보조 저장 장치에 잠들어 있으며, 이들은 실행될 때 주 기억 장치*Main Memory*로 적재된다. 이렇게 주 기억 장치에 적재돼 실행 준비를 마친, 혹은 실행 중인 프로그램을 '프로세스*Process*' 라 부르게 되며, 프로그램과 달리 이들은 자신이 현재 얼마나 실행되었는지, 어떤 연산을 수행하고 있었는지를 PCB(Process Context Block)의 형태로 가지게 된다.

## 4. 메모리에서 프로세서로

메모리에 적재된 프로세스는 프로세서(CPU)에 의해 처리가 시작되는데, 이는 대략적으로 다음과 같은 형태로 수행된다.

* CPU의 PC(Program Counter)가 프로세스의 명령어 주소를 가리킨다.
* 해당 주소에서 명령어를 가져와 해독한다(이 과정에서 버스 및 MAR, MBR, IC, CU등 다양한 레지스터가 사용된다)
* 해독된 명령어에 맞게 명령을 수행한다(이 역시 다양한 레지스터와 버스의 도움을 받는다)
* PC를 1(Word) 증가시켜 다음 명령어 주소를 가리킨다.

이 과정을 프로세스의 모든 명령어를 수행할 때까지 반복하게 된다.

## 5. 캐시(Cache)

여기서 중요한 점은 명령어와 데이터가 이동하는 경로이다. 맨 처음 우리의 Hello World 프로그램은 보조 저장 장치 상에 존재했지만, 프로그램 실행 시 메모리에 적재되고, 프로그램이 한 줄씩 실행되면서 필요한 데이터들이 메모리에서 레지스터로 적재된다. 이처럼 컴퓨터 시스템의 저장 장치들은 계층 구조를 지닌 채로 아랫 계층에서 윗 계층으로 순차적으로 적재되는데, 이러한 메모리 계층 구조는 **캐시*Cache***의 탄생으로 이어지게 된다.

만약 메모리에서 꺼내온 데이터를 사용한 직후 또 사용해야 한다면, 다시 메모리에서 데이터를 가져오는 것 보다 레지스터에 잠시 저장해 놓은 채로 이를 다시 사용하는 것이 물리적으로 훨씬 빠를 것이다. 이러한 '캐싱' 아이디어는 실제 컴퓨터 시스템에서 큰 효율 개선을 제공하는데, 이는 **지역성의 원리** 에 기반한다.

시간적, 공간적, 순차적 지역성에 의해 대부분의 코드와 데이터는 한 번 사용될 경우 빠른 시간 내에 재사용 될 가능성이 높고, 이러한 데이터를 매 번 메모리에서 프로세서로 가져오는 대신 그 사이에 작지만 고속의 저장 장치인 캐시를 두어 데이터의 중간 경유지로 삼는다. 이를 통해 재사용될 데이터를 메모리까지 가지 않아도 캐시에서 찾아 가져올 수 있어 프로그램의 수행 속도가 크게 상승한다. 

## 6. 다중 프로세스와 추상화

추후 작성
